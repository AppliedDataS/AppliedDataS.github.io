<!DOCTYPE html>

<html lang="en">
<head>
<title>Jacobian</title>
<meta charset="utf-8"/>
<link href="../css/style.css" rel="stylesheet" type="text/css"/>
<link href="../css/prism.css" rel="stylesheet" type="text/css"/>
<link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" rel="stylesheet"/>
<link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" rel="stylesheet"/>
<!-- The loading of KaTeX is deferred to speed up page rendering -->
<script crossorigin="anonymous" defer="" integrity="sha384-PwRUT/YqbnEjkZO0zZxNqcxACrXe+j766U2amXcgMg5457rve2Y7I6ZJSm2A0mS4" src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js"></script>
<!-- To automatically render math in text elements, include the auto-render extension: -->
<script crossorigin="anonymous" defer="" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" onload="renderMathInElement(document.body);" src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js"></script>
</head>
<body>
<div class="container">
<!--navbar here -->
<div id="navbar"><nav class="navbar navbar-expand-lg bg-body-tertiary">
<div class="container-fluid">
<a class="navbar-brand" href="index.html">Sophie's Coding Journey</a>
<button aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-bs-target="#navbarNav" data-bs-toggle="collapse" type="button">
<span class="navbar-toggler-icon"></span>
</button>
<div class="collapse navbar-collapse" id="navbarNav">
<ul class="navbar-nav">
<li class="nav-item">
<a aria-current="page" class="nav-link active" href="../index.html">Home</a>
</li>
<li class="nav-item">
<a class="nav-link" href="./html/about.html">About Me</a>
</li>
<li class="nav-item">
<a class="nav-link" href="./html/research_intersts.html">Research Interests</a>
</li>
<li class="nav-item">
<a class="nav-link" href="./html/general_intersts.html">General Interests</a>
</li>
</ul>
</div>
</div>
</nav></div>
<div class="row">
<div class="col-12">
<h1 class="title">Jacobian</h1>
</div>
</div>
<div class="row">
<div class="col-12" id="dynamic_content">
<!-- pages here-->

<div>
</div>
<h3> Understanding Jacobian functions through explicit differentiation
</h3>

<h4> Many examples
</h4>

<span>Jacobian of a single function of many variables
</span>
<div id="latex-code">
<p class="katex">
\begin{equation*}
f(x1,x2,x3,...xn)
\end{equation*}

</p>
</div>
<div id="latex-code">
<p class="katex">
\begin{equation*}
    J=
\begin{bmatrix}
\frac{\partial f}{\partial x_1}&amp;, \frac{\partial f}{\partial x_2}&amp;,\frac{\partial f}{\partial x_3} &amp;, ... &amp;,\frac {\partial f}{\partial x_n}
\end{bmatrix}
\end{equation*}
</p>
</div>

<div>
</div>
<div>
<pre>
<code class="language-python">try:  
  from sympy import *
except ModuleNotFoundError as e:
  print(e)
  !export PATH="/opt/homebrew/bin:$PATH"
  %pip install -r ../requirements.txt
x = Symbol('x')
y = Symbol('y')
z = Symbol('z')
f = x**2 * y + 3 * z
fpx = diff(f,x)
fpy = diff(f,y)
fpz = diff(f,z)
print(fpx)
print(fpy)
print (fpz)
</code>
</pre>
</div>

<div>
</div>
<h3> Working Out the Jacobian for an example function
</h3>

<span>for the function
</span>

<div>
</div><div id="latex-code">
<p class="katex">
\begin{equation*}
f(x) = x^{2}y+3z
\end{equation*}
</p>
</div>

<div>
</div>
<span>The partial derivatives of the function with respect to x, y and z are:</span>

<div>
</div><div id="latex-code">
<p class="katex">
\begin{equation*}
\frac {\partial f}{\partial x} = 2xy
\end{equation*}

</p>
</div>
<div id="latex-code">
<p class="katex">
\begin{equation*}
\frac {\partial f}{\partial y} = x^{2}
\end{equation*}

</p>
</div>
<div id="latex-code">
<p class="katex">
\begin{equation*}
\frac {\partial f}{\partial z} = 3
\end{equation*}

</p>
</div>

<span>hence the Jacobian is
</span>
<div id="latex-code">
<p class="katex">
\begin{equation*}
J = \begin{bmatrix}
2xy &amp; x^{2} &amp; 3
\end{bmatrix}
\end{equation*}
</p>
</div>

<div>
</div>
<span>We now have an algebraic expression for a vector which when we give it a specific x, y, z coordinate, will return a vector pointing in __the direction of steepest slope of this function__. The vector for this particular function has a constant contribution in the z direction which does not depend on the location selected. </span>

<div>
</div>
<h3> Calculating the Jacobian Quiz
</h3>

<span>[Coursera's Multivariant Calculus Course](https://www.coursera.org/learn/multivariate-calculus-machine-learning/)</span>

<div>
</div>
<div>
<pre>
<code class="language-python"># Q1
x = Symbol('x')
y = Symbol('y')
f = x**2 * y + 3/4*x*y+10
fpx = diff(f,x)
fpy = diff(f,y)
print(fpx)
print(fpy)

</code>
</pre>
</div>

<div>
</div>
<h5> Question 1 Solution:</h5>

<div>
</div><div id="latex-code">
<p class="katex">
\begin{equation*}
\frac{\partial f}{\partial x} = 2xy + \frac{3}{4}y
\end{equation*}

</p>
</div>
<div id="latex-code">
<p class="katex">
\begin{equation*}
\frac{\partial f}{\partial y} = x^{2} + \frac{3}{4}x
\end{equation*}
</p>
</div>

<div>
</div>
<div>
<pre>
<code class="language-python"># Q2
x = Symbol('x')
y = Symbol('y')
z = Symbol('z')
f = exp(x)*cos(y) + x*exp(3*y)-2
fpx = diff(f,x)
fpy = diff(f,y)
fpz = diff(f,z)
print(latex(fpx))
print(latex(fpy))
print (latex(fpz))
</code>
</pre>
</div>

<div>
</div>
<h5> Question 2 Solution:</h5>

<div>
</div><div id="latex-code">
<p class="katex">
\begin{equation*}
\frac{\partial f}{\partial x} = e^{x} \cos{\left(y \right)} + e^{3 y}
\end{equation*}

</p>
</div>
<div id="latex-code">
<p class="katex">
\begin{equation*}
\frac{\partial f}{\partial y} = x^{2} + \frac{3}{4}x
\end{equation*}
</p>
</div>

<div>
</div>
<div>
<pre>
<code class="language-python"># Q3
x = Symbol('x')
y = Symbol('y')
z = Symbol('z')
f = exp(x)*cos(y) +x**2 * y**2 * z**2
fpx = diff(f,x)
fpy = diff(f,y)
fpz = diff(f,z)
print(latex(fpx))
print(latex(fpy))
print (latex(fpz))
</code>
</pre>
</div>

<div>
</div>
<h5> Question 3 Solution:</h5>

<div>
</div><div id="latex-code">
<p class="katex">
\begin{equation*}
\frac{\partial f}{\partial x} = 2 x y^{2} z^{2} + e^{x} \cos{\left(y \right)}
\end{equation*}

</p>
</div>
<div id="latex-code">
<p class="katex">
\begin{equation*}
\frac{\partial f}{\partial y} = 2 x^{2} y z^{2} - e^{x} \sin{\left(y \right)}
\end{equation*}

</p>
</div>
<div id="latex-code">
<p class="katex">
\begin{equation*}
\frac{\partial f}{\partial z} = 2 x^{2} y^{2} z
\end{equation*}
</p>
</div>

<div>
</div>
<div>
<pre>
<code class="language-python"># Q4
x = Symbol('x')
y = Symbol('y')
z = Symbol('z')
f = x**2 +3 * exp(y) * exp(z) + cos(x) * sin(z)
fpx = diff(f,x)
fpy = diff(f,y)
fpz = diff(f,z)
print(latex(fpx))
print(latex(fpy))
print (latex(fpz))
pnt = {x: 0,y: 0,z: 0}
J0 = [fpx.subs(pnt), fpy.subs(pnt), fpz.subs(pnt)]
J0
</code>
</pre>
</div>

<div>
</div>
<h5> Question 4 Solution:</h5>

<div>
</div><div id="latex-code">
<p class="katex">
\begin{equation*}
\frac{\partial f}{\partial x} = 2 x - \sin{\left(x \right)} \sin{\left(z \right)}
\end{equation*}

</p>
</div>
<div id="latex-code">
<p class="katex">
\begin{equation*}
\frac{\partial f}{\partial y} = 3 e^{y} e^{z}
\end{equation*}

</p>
</div>
<div id="latex-code">
<p class="katex">
\begin{equation*}
\frac{\partial f}{\partial z} = 3 e^{y} e^{z} + \cos{\left(x \right)} \cos{\left(z \right)}
\end{equation*}
</p>
</div>

<div>
</div>
<span>substituting {x: 0,y: 0,z: 0} we get</span>

<div>
</div><div id="latex-code">
<p class="katex">
\begin{equation*}
J(0, 0, 0) =[0, 3, 4] 
\end{equation*}
</p>
</div>

<div>
</div>
<div>
<pre>
<code class="language-python"># Q5
x = Symbol('x')
y = Symbol('y')
z = Symbol('z')
f = x * exp(y) * cos(z) + 5 * x**2 * sin(y) * exp(z)
fpx = diff(f,x)
fpy = diff(f,y)
fpz = diff(f,z)
print(latex(fpx))
print(latex(fpy))
print (latex(fpz))
pnt = {x: 0,y: 0,z: 0}
J0 = [fpx.subs(pnt), fpy.subs(pnt), fpz.subs(pnt)]
J0
</code>
</pre>
</div>

<div>
</div>
<h5> Question 5 Solution:
</h5>
<div id="latex-code">
<p class="katex">
\begin{equation*}
\frac{\partial f}{\partial x} = 10 x e^{z} \sin{\left(y \right)} + e^{y} \cos{\left(z \right)}
\end{equation*}

</p>
</div>
<div id="latex-code">
<p class="katex">
\begin{equation*}
\frac{\partial f}{\partial y} = 3 e^{y} e^{z}
\end{equation*}

</p>
</div>
<div id="latex-code">
<p class="katex">
\begin{equation*}
\frac{\partial f}{\partial z} = 5 x^{2} e^{z} \sin{\left(y \right)} - x e^{y} \sin{\left(z \right)}
\end{equation*}

</p>
</div>

<span>substituting {x: 0,y: 0,z: 0} we get
</span>
<div id="latex-code">
<p class="katex">
\begin{equation*}
J(0, 0, 0) =[1, 0, 0] 
\end{equation*}
</p>
</div>

<div>
</div><div id="latex-code">
<p class="katex">
\begin{equation*}
u(x,y) = x - 2 y 
\end{equation*}

</p>
</div>
<div id="latex-code">
<p class="katex">
\begin{equation*}
v(x,y) = 3 y - 2 x
\end{equation*}

</p>
</div>
<div id="latex-code">
<p class="katex">
\begin{equation*}
J_u = 
\begin{matrix}
[ \frac{\partial_u}{\partial_x} &amp;  \frac{\partial_u}{\partial_y} ]
\end{matrix}
\end{equation*}

</p>
</div>
<div id="latex-code">
<p class="katex">
\begin{equation*}
J_v = 
\begin{matrix}
[ \frac{\partial_v}{\partial_x} &amp;  \frac{\partial_v}{\partial_y} ]
\end{matrix}
\end{equation*}

</p>
</div>
<div id="latex-code">
<p class="katex">
\begin{equation*}
J = 
\begin{bmatrix}
\frac{\partial_u}{\partial_x} &amp;  \frac{\partial_u}{\partial_y} \\
\\
 \frac{\partial_v}{\partial_x} &amp;  \frac{\partial_v}{\partial_y} 
\end{bmatrix}
\end{equation*}
</p>
</div>

<div>
</div>
<h4> Matrix Jacobians
</h4>

<span><img src="../matrix_jac_1.png" width="70%"/>
</span>

<span><br/><br/>
</span>

<span>The Jacobians of a matrix can be computed using the following methods:</span>

<div>
</div>
<div>
<pre>
<code class="language-python"># Q5
import numpy as np
x = Symbol('x')
y = Symbol('y')
u = x -(2 * y)
v = 3 * y  - (2 * x)
ux = diff(u,x)
uy = diff(u,y)
vx = diff(v,x)
vy = diff(v,y)
J = [[ux,uy],[vx,vy]]
print(J)
print(latex(ux))
print(latex(uy))
print(latex(vx))
print(latex(vy))
print(latex(u))
print(latex(v))
# print (latex(fpz))
# pnt = {x: 0,y: 0,z: 0}
# J0 = [fpx.subs(pnt), fpy.subs(pnt), fpz.subs(pnt)]
# J0
</code>
</pre>
</div>

<div>
</div><div id="latex-code">
<p class="katex">
\begin{equation*}
u(x,y) = x - 2 y^{3}
\end{equation*}

</p>
</div>
<div id="latex-code">
<p class="katex">
\begin{equation*}
v(x,y) =- 2 x^{3} + 3 y^{2}
\end{equation*}

</p>
</div>

<span>hence the derived Jacobian is 
</span>
<div id="latex-code">
<p class="katex">
\begin{equation*}
J = 
\begin{bmatrix}
1 &amp;, - 6 y^{2} \\

- 6 x^{2} &amp;, 6 y
\end{bmatrix}
\end{equation*}
</p>
</div>

<div>
</div>
<h3> Bigger Jacobians Quiz</h3>

<div>
</div>
<div>
<pre>
<code class="language-python"># Q1
import numpy as np
x = Symbol('x')
y = Symbol('y')
u = 9*x**2 * y**2 + z*exp(x) 
v = x*y + x**2 * y**3 + 2*z
w = cos(x)*sin(z)*exp(y)
ux = diff(u,x)
uy = diff(u,y)
uz = diff(u,z)
vx = diff(v,x)
vy = diff(v,y)
vz = diff(v,z)
wx = diff(w,x)
wy = diff(w,y)
wz = diff(w,z)
# print(J)
print("ux --&gt;",latex(ux))
print("uy --&gt;",latex(uy))
print("uz --&gt;",latex(uz))
print("vx --&gt;",latex(vx))
print("vy --&gt;",latex(vy))
print("vz --&gt;",latex(vz))
print("wx --&gt;",latex(wx))
print("wy --&gt;",latex(wy))
print("wz --&gt;",latex(wz))
print("u(x,y,z) =" ,latex(u))
print("v(x,y,z) =",latex(v))
print("w(x,y,z) =", latex(w))
pnt = {x: 0,y: 0,z: 0}
jPnt = [[ux.subs(pnt),uy.subs(pnt),uz.subs(pnt)],
        [vx.subs(pnt),vy.subs(pnt),vz.subs(pnt)],
        [wx.subs(pnt),wy.subs(pnt),wz.subs(pnt)]]
print(jPnt)
</code>
</pre>
</div>

<div>
</div>
<h4> Solution for Q1
</h4>
<div id="latex-code">
<p class="katex">
\begin{equation*}
u(x,y,z) = 9 x^{2} y^{2} + z e^{x}
\end{equation*}

</p>
</div>
<div id="latex-code">
<p class="katex">
\begin{equation*}
v(x,y,z) = x^{2} y^{3} + x y + 2 z
\end{equation*}

</p>
</div>
<div id="latex-code">
<p class="katex">
\begin{equation*}
w(x,y,z) = e^{y} \sin{\left(z \right)} \cos{\left(x \right)}
\end{equation*}

</p>
</div>

<span>hence the derived Jacobian is 
</span>
<div id="latex-code">
<p class="katex">
\begin{equation*}
J = 
\begin{bmatrix}
18 x y^{2} + z e^{x} &amp; 
18 x^{2} y &amp;
e^{x}\\
\\
2 x y^{3} + y &amp; 
3 x^{2} y^{2} + x &amp; 
2 \\
\\
- e^{y} \sin{\left(x \right)} \sin{\left(z \right)}&amp;
e^{y} \sin{\left(z \right)} \cos{\left(x \right)}&amp;
e^{y} \cos{\left(x \right)} \cos{\left(z \right)}
\end{bmatrix}
\end{equation*}

</p>
</div>

<span>Evaluating the Jacobian at x=0, y=0, z=0 gives
</span>
<div id="latex-code">
<p class="katex">
\begin{equation*}
\begin{bmatrix}
0 &amp; 0 &amp; 1 \\
0 &amp; 0 &amp; 2 \\
0 &amp; 0 &amp; 1
\end{bmatrix}
\end{equation*}
</p>
</div>

<div>
</div>
<div>
<pre>
<code class="language-python"># Q2
import numpy as np
r = Symbol('r')
theta = Symbol('theta')
phi = Symbol('phi')
u = r * cos(theta) * sin(phi)
v = r * sin(theta) * sin(phi)
w = r * cos(phi)
ux = diff(u,r)
uy = diff(u,theta)
uz = diff(u,phi)
vx = diff(v,r)
vy = diff(v,theta)
vz = diff(v,phi)
wx = diff(w,r)
wy = diff(w,theta)
wz = diff(w,phi)
# print(J)
print("ux --&gt;",latex(ux))
print("uy --&gt;",latex(uy))
print("uz --&gt;",latex(uz))
print("vx --&gt;",latex(vx))
print("vy --&gt;",latex(vy))
print("vz --&gt;",latex(vz))
print("wx --&gt;",latex(wx))
print("wy --&gt;",latex(wy))
print("wz --&gt;",latex(wz))
print("u(x,y,z) =" ,latex(u))
print("v(x,y,z) =",latex(v))
print("w(x,y,z) =", latex(w))
pnt = {r: 1,theta: pi/4,phi: pi/4}
jPnt = [[ux.subs(pnt),uy.subs(pnt),uz.subs(pnt)],
        [vx.subs(pnt),vy.subs(pnt),vz.subs(pnt)],
        [wx.subs(pnt),wy.subs(pnt),wz.subs(pnt)]]
print(jPnt)
</code>
</pre>
</div>

<div>
</div>
<h4> Solution for Q2
</h4>
<div id="latex-code">
<p class="katex">
\begin{equation*}
u(r,\theta,\phi) = r \sin{\left(\phi \right)} \cos{\left(\theta \right)}
\end{equation*}

</p>
</div>
<div id="latex-code">
<p class="katex">
\begin{equation*}
v(r,\theta,\phi) = r \sin{\left(\phi \right)} \sin{\left(\theta \right)}
\end{equation*}

</p>
</div>
<div id="latex-code">
<p class="katex">
\begin{equation*}
w(r,\theta,\phi) = r \cos{\left(\phi \right)}
\end{equation*}

</p>
</div>

<span>hence the derived Jacobian is 
</span>
<div id="latex-code">
<p class="katex">
\begin{equation*}
J = 
\begin{bmatrix}
\sin{\left(\phi \right)} \cos{\left(\theta \right)} &amp; 
- r \sin{\left(\phi \right)} \sin{\left(\theta \right)} &amp;
r \cos{\left(\phi \right)} \cos{\left(\theta \right)} \\
\\
\sin{\left(\phi \right)} \sin{\left(\theta \right)} &amp; 
r \sin{\left(\phi \right)} \cos{\left(\theta \right)} &amp; 
r \sin{\left(\theta \right)} \cos{\left(\phi \right)} \\
\\
\cos{\left(\phi \right)} &amp;
0 &amp;
- r \sin{\left(\phi \right)}
\end{bmatrix}
\end{equation*}

</p>
</div>

<span>Evaluating the Jacobian at 
</span>
<div id="latex-code">
<p class="katex">
\begin{equation*}
r = 0, \theta = 0, \phi = 0
\end{equation*}

</p>
</div>

<span>gives
</span>
<div id="latex-code">
<p class="katex">
\begin{equation*}
\begin{bmatrix}
0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 1
\end{bmatrix}
\end{equation*}

</p>
</div>

<span>Evaluating the Jacobian at 
</span>
<div id="latex-code">
<p class="katex">
\begin{equation*}
r = 1, \theta = 0, \phi = 0
\end{equation*}

</p>
</div>

<span>gives
</span>
<div id="latex-code">
<p class="katex">
\begin{equation*}
\begin{bmatrix}
0 &amp; 0 &amp; 1 \\
0 &amp; 0 &amp; 2 \\
0 &amp; 0 &amp; 1
\end{bmatrix}
\end{equation*}

</p>
</div>

<span>Evaluating the Jacobian at 
</span>
<div id="latex-code">
<p class="katex">
\begin{equation*}
r = 1, \theta = \frac{\pi}{4}, \phi = \frac{\pi}{4}
\end{equation*}

</p>
</div>

<span>gives
</span>
<div id="latex-code">
<p class="katex">
\begin{equation*}
\begin{bmatrix}
\frac{1}{2} &amp; - \frac{1}{2} &amp; \frac{1}{2}\\
\\
\frac{1}{2} &amp; \frac{1}{2} &amp; \frac{1}{2}\\
\\
\frac{\sqrt{2}}{2} &amp; 0 &amp;  - \frac{\sqrt{2}}{2}
\end{bmatrix}
\end{equation*}

</p>
</div>
</div>
</div>
</div>
<script crossorigin="anonymous" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js">
</script>
<script src="js/prism.js">
</script>
</body>
</html>